      function fngam(energy,kkk,istep)
      implicit none
c      common/pawpar/ alfa1(40)
      integer i, kkk,istep,j
      real mult, en, energy,e1,alfa(100)
      real matrix(10,10),b(10),alfa1(40),fngam
      data alfa1/0.049515288323164,-0.026104193180799,
     &  -0.003745806869119,0.001938418718055,0.000131756154587,
     &  -0.000062817583967,0.000000228213494,0.000000363244709,
     &   0.000000000000000,0.000000000000000,
     &   0.022824529558420,-0.017408052459359,0.003861683886498,
     &  -0.000143469791510,0.000092240108643,-0.000044387936214,
     &   0.000004931090643,-0.000000143157337,0.000000000000000,
     &   0.000000000000000,
     &   0.008879916742444,-0.003619404975325,-0.002334999619052,
     &   0.001504373271018,-0.000144941615872,-0.000037195237383,
     &   0.000007089117844,-0.000000304633062,0.000000000000000,
     &   0.000000000000000,
     &   0.028806120157242,-0.186462894082069,0.202944248914719,
     &  -0.071261405944824,0.006978045683354,0.000970670080278,
     &  -0.000224855364650,0.000011120862837,0.000000000000000,
     &   0.000000000000000/
      mult = 1000.
c      istep=1
c      kkk=3
      e1=energy/mult
c      open(27,file='e_cor_matrix.dat',form='formatted',status='old')
c      read(27,*) kkk
c      read(27,*) istep
c      read(27,1) matrix
c      read(27,2) b
c      read(27,3)alfa
c      close(27)
      do j=1,istep
         en = e1 + alfa1((j-1)*10+1)
c      write(*,*)'ecor:',kkk
         do i = 2, kkk
            en = en + alfa1((j-1)*10+i)*((e1)**i)
c            write(*,*)alfa1((j-1)*10+i)
         enddo
         e1 = en
      enddo
      fngam=e1*mult
      return
 1    format(10(10F20.3/))
 2    format(10F20.3/)
 3    format(10(10F20.15/))
      end
